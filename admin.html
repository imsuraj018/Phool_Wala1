<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PHOOLWALA Admin</title>
<style>
body{font-family:Arial,sans-serif;margin:0;padding:20px;background:#fffdfa;}
h1{text-align:center;color:#c4712e;}
table{width:100%;border-collapse:collapse;margin-top:20px;}
th,td{border:1px solid #ccc;padding:8px;text-align:center;}
th{background:#f7f5f0;}
.no-orders{text-align:center;color:#72543d;padding:15px;}
</style>
</head>
<body>
<h1>Admin Orders</h1>
<table id="ordersTable">
<thead>
<tr>
<th>ID</th><th>Name</th><th>Phone</th><th>Address</th><th>Quantity(KG)</th><th>Date</th><th>Slot</th><th>Comments</th><th>Ordered At</th>
</tr>
</thead>
<tbody>
<tr class="no-orders"><td colspan="9">Loading orders...</td></tr>
</tbody>
</table>

<script>
async function loadOrders(){
  const tbody = document.querySelector('#ordersTable tbody');
  try{
    const res = await fetch('http://localhost:3000/admin/orders');
    if(!res.ok) throw new Error(`Server error: ${res.status}`);
    const orders = await res.json();
    tbody.innerHTML = '';
    if(orders.length === 0){
      tbody.innerHTML = '<tr class="no-orders"><td colspan="9">No orders yet.</td></tr>';
      return;
    }
    orders.forEach(o => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${o.id}</td>
        <td>${o.name}</td>
        <td>${o.phone}</td>
        <td>${o.address}</td>
        <td>${o.quantity}</td>
        <td>${o.date}</td>
        <td>${o.slot}</td>
        <td>${o.comments || ''}</td>
        <td>${new Date(o.created_at).toLocaleString()}</td>
      `;
      tbody.appendChild(row);
    });
  }catch(err){
    console.error("Error loading orders:", err);
    tbody.innerHTML = '<tr class="no-orders"><td colspan="9">Error loading orders. Check console.</td></tr>';
  }
}
loadOrders();
setInterval(loadOrders,5000);
</script>
</body>
</html>
